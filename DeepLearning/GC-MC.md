# GC-MC 论文笔记

## 一、定义

定义一个矩阵$ M $，其代表离散的用户评分值。当$ M_{ij}=0 $， 则代表 $i$ 用户对事物 $j$ 的评分未知或不确定



如下是一个矩阵的实例

![2022-04-28 21-05-40 的屏幕截图](/home/danielgu/Pictures/2022-04-28 21-05-40 的屏幕截图.png)

那么实际上，我们很容易将这个问题转化为一个二分图问题。也就是基于已有的矩阵 $M$ ，画出一个用户和事物的联系无向图。每条边代表了单个用户对对应事物的评分

同时，我们也可以通过设计一个解码器 $Z$ ，将联系图直接补全。这便是本文要讨论的主要问题

![2022-04-28 21-25-09 的屏幕截图](/home/danielgu/Pictures/2022-04-28 21-25-09 的屏幕截图.png)

更精确的，我们定义**交互图** $G$ 如下
$$
G=(\mathcal{W},\mathcal{E},\mathcal{R})
$$
定义用户节点 $u_i\in \mathcal{U},i\in\{1,...,N_u\}$

定义事物节点 $v_j\in \mathcal{V},j\in\{1,...,N_v\}$

故我们知道，$\mathcal{U}\cup\mathcal{V}=\mathcal{W}$

定义评分等级 $r\in\{1,...,R\}=\mathcal{R}$

可以知道，所有的边上，权值的类型均属于 $\mathcal{R}$

定义编码器 $Z=f(X,A)$ ，其中 $X$ 为输入矩阵，形状为 $N\times D$，$A$ 为图邻接矩阵

故我们得到一个大小为 $N\times E$ 内嵌的矩阵 $Z=[z^T_1,...,z^T_N]^T$

定义解码器 $\check{A}=g(Z)$ ，其中一对 $(z_i,z_j)$ 将产出一个邻接 $\check{A_{ij}}$的预测值

注意，$N$ 代表节点数量，$D$ 代表输入数量，$E$ 代表内嵌核大小 

对于二分图，我们可以将**编码器**重定义为
$$
[U,V]=f(X,M_1,...,M_R)
$$
其中 $M_r\in\{0,1\}^{N_u\times N_v}$ ，代表在 $r$ 评分下，其是否与对应 $u$ 用户和 $v$ 事物连接

说人话就是 $u$ 用户对 $v$ 事物做出了 $r$ 评分，则$(M_r)_{ij}=1$ ，否则为 $0$

$U$ 和 $V$ 是一个内嵌矩阵，其形状分别为 $N_u\times E$ 和 $N_v\times E$

因此，单个用户 $i$ （或事物 $j$ ）的内嵌向量为 $U_{i,:}$（或 $V_{j,:}$）

同样的，我们也可以对**解码器**进行重定义如下
$$
\check{M}=g(U,V)
$$
其中得到预测矩阵 $\check{M}$ 的形状为  $N_u\times N_v$

![2022-04-29 14-46-52 的屏幕截图](/home/danielgu/Pictures/2022-04-29 14-46-52 的屏幕截图.png)

我们可以将预测的矩阵 $\check{M}$ 和真实值 $M$ 进行比对，同时使用 $RMSE$ 计算损失

## 二、图卷积编码器

本文针对推荐任务提出一种图自编码器的变体图卷积编码器。本文提出的编码器模型可以有效利用图形中各个位置之间的权重分配，并为每种边类型（或评分）$r \in\mathcal{R}$ 分配单独的处理通道